---
title: "1/ Quartoとは"
modified-date: today
format: 
  revealjs:
    footer: "Quartoとは"
    mermaid:
      theme: neutral
metadata-files: 
  - "style/slide.yml"
---

{{< include _common.qmd >}}

## 自己紹介

:::: {.columns}
::: {.column width=30%}
![](figs/intro/profile.png)
:::

::: {.column width=70%}
- **講義名：**社会科学における因果推論
- **担当教員：**<ruby>宋<rt>そん</rt></ruby><ruby>財泫<rt>じぇひょん</rt></ruby>
   - 関西大学総合情報学部　准教授
   - 博士（政治学）
- <i class="bi bi-house"></i> <https://www.jaysong.net/>
- <i class="bi bi-envelope"></i> song<i class="bi bi-at"></i>kansai-u.ac.jp
:::
::::

# **1** Quarto?

## まずはR Markdownから

![](figs/intro/rmarkdown_logo.png){width=250px fig-align="center"}

- {knitr}[（2012年頃）]{.small}と{rmarkdown}[（2014年頃）]{.small}パッケージの登場
- Rのコードと結果、文章が一つの文書としてまとめたもの
   - HTML、Microsoft Word、PDF等
- 外部パッケージを使用することで様々な出力物が作成可能
   - スライド[（{xaringan}）]{.small}、ホームページ[（{blogdown}）]{.small}、書籍[（{bookdown}）]{.small}など
- R + Markdown $\rightarrow$ [**Markdownって何?**]{.alert}

## プレーンテキストとリッチテキスト

- **Plain text：**純粋な[テキストのみで構成]{.alert}されている文書（図表、書式情報$\times$）
  - macOSのテキストエディット、Windowsのメモ帳、VS Code、Vimなど
- **Rich text：**テキストだけでなく、[書式情報、図表なども含まれる]{.alert}文書
  - 書式情報の例: 文書の余白、行間の幅、文字サイズ、太さ、色
  - Microsoft Word、Apple Pages、LibreOffice Writer、一太郎など
- リッチテキストには文字情報以外にも様々な書式情報が含まれているため、サイズが大きく、パソコンへの負担も大きい（$\doteqdot$ `.xlsx` vs. `.csv`）

## プレーンテキストからリッチテキストへ

- [**Markup**]{.alert}言語：プレーンテキストをリッチテキストへ変換するための言語
- HTML[（HyperText **Markup** Language）]{.small}が代表的
  - 例1） `<b>`と`</b>`で囲まれた文字は太字として出力される。
  - 例2） `<a>`と`</a>`で囲まれた文字はリンクであり、`<a>`の`href`引数で指定されたリンク先へ飛ばされる。
- Webブラウザ[（Chrome、Firefox、Edge、Safari等）]{.small}はHTMLをリッチテキストへ変換するレンダリングエンジン[（Gecko、Blink、WebKit等）]{.small}を搭載している

**Input:**

```html
この文字は<b>太字</b>にしましょう。<br/>
<a href = "https://www.jaysong.net">ここ</a>をクリックしてください。
```

**Output:**

この文字は**太字**にしましょう。<br/>
[ここ](https://www.jaysong.net)をクリックしてください。

## Markdownとは

- Mark[**down**]{.alert}（<i class="bi bi-markdown"></i>）: Mark[**up**]{.alert}言語の軽量版
   - 文章作成に必要なタグ[（tag）]{.small}を、より簡単に記述できる。

**Markup**の場合[（HTML）]{.small}

```html
この文字は<b>太字</b>にしましょう。<br/>
<a href = "https://www.jaysong.net">ここ</a>をクリックしてください。
```

**Markdown**の場合

```md
この文字は**太字**にしましょう。

[ここ](https://www.jaysong.net)をクリックしてください。
```

**結果**

この文字は**太字**にしましょう。<br/>
[ここ](https://www.jaysong.net)をクリックしてください。

## Markup vs. Markdown（表）

:::: {.columns}

::: {.column width="70%"}
**Markup**（HTML）

```html
<table>
    <thead style = "font-weight:bold;">
        <td>ID</td>
        <td>Name</td>
    </thead>
    <tr>
        <td>1</td>
        <td>Quarto</td>
    </tr>
    <tr>
        <td>2</td>
        <td>Markdown</td>
    </tr>
</table>
```
:::

::: {.column width="30%"}
**Markdown**

```markdown
| ID | Name     |
|----|----------|
| 1  | Quarto   |
| 2  | Markdown |
```

**Output**

| ID | Name     |
|----|----------|
| 1  | Quarto   |
| 2  | Markdown |
:::
::::

## Markup vs. Markdown（箇条書き1）

:::: {.columns}

::: {.column width="50%"}
**Markup**（HTML）

```html
<ul>
  <li>箇条書き1</li>
    <ul>
      <li>箇条書き1A</li>
      <li>箇条書き1B</li>
    </ul>
  <li>箇条書き2</li>
  <li>箇条書き3</li>
</ul>
```
:::

::: {.column width="50%"}
**Markdown**

```markdown
- 箇条書き1
   - 箇条書き1A
   - 箇条書き1B
- 箇条書き2
- 箇条書き3
```

**Output**

- 箇条書き1
   - 箇条書き1A
   - 箇条書き1B
- 箇条書き2
- 箇条書き3
:::
::::

## Markup vs. Markdown（箇条書き2）

:::: {.columns}

::: {.column width="50%"}
**Markup**（HTML）

```html
<ol>
  <li>箇条書き1</li>
    <ol>
      <li>箇条書き1A</li>
      <li>箇条書き1B</li>
    </ol>
  <li>箇条書き2</li>
  <li>箇条書き3</li>
</ol>
```
:::

::: {.column width="50%"}
**Markdown**

```markdown
1. 箇条書き1
   1. 箇条書き1A
   1. 箇条書き1B
1. 箇条書き2
1. 箇条書き3
```

**Output**

1. 箇条書き1
   1. 箇条書き1A
   1. 箇条書き1B
1. 箇条書き2
1. 箇条書き3
:::

::::

## Quartoの登場

2026年2月現在、Quartoは[R Markdownの（ほぼ）上位互換]{.alert}だと考えても良い

![](figs/intro/quarto_logo.svg){width=250px fig-align="center"}

- 2022年7月登場（Ver. 1.0）したR markdownの後継
- 読み方は「[**クゥオート**]{.alert}」[（クワトロじゃない）]{.small}
- 断片化されつつある[R Markdown生態系を一つに統合]{.alert}したもの
  - R Markdown界隈の{blogdown}、{bookdown}、{xaringan}、...
  - Quartoは別途のパッケージ不要
- [R以外の言語、knitr以外のエンジン]{.alert}も使用可能
- R Markdownと[使い方はほぼ同じ]{.alert}

# **2** Why Quarto?

## なぜQuarto/R Markdownを使うか

Quarto/R Markdownは[**文芸的プログラミング**]{.alert}[（literate programming）]{.small}のツール

- **文芸的プログラミング**：ソースコードとドキュメントを別々のファイルに記入せず、一つのファイルでまとめるプログラミングのスタイル
   - 既存の「コード + コメント[（`#`、`//`、`<!-- ~ -->`、...）]{.small}」より発展した概念
   - プログラミングの界隈では流行らなかったが...

<br/>

### 学術研究における文芸的プログラミングとは...

- 「何をしたか[（**code**）]{.small}」と「そこから何が得られたか[（**result**）]{.small}」、「説明[（**narrative**; なぜそうしたか、その結果は何を意味するか、...）]{.small}」を同じ場所に記述すること
   - 例）既存のやり方：**R**で分析し、推定結果や作成した図を**LaTeX、Word**に貼り付けながら論文や資料を作成
   - 例）文芸的プログラミングのやり方：**Quarto**

## 文芸的プログラミングのすゝめ

- 「手作業」の排除によるエラー防止[（自動化）]{.small}
- 分析プロセスの透明化
- バージョン管理システムとの親和性
- 環境依存性の記述とポータビリティ

| | 従来のツール（R + Word） | Quarto |
|:---|:---------|:---------|
|プロセス|手作業の連続[（分断）]{.small}|コードによる自動化[（統合）]{.small}|
|変更への対応|最初からやり直し[（高コスト）]{.small}|再実行のみ[（低コスト）]{.small}|
|透明性|操作履歴が見えにくい|コードですべて可視化される|
|再現性|低い[（人の記憶や手作業に依存）]{.small}|高い[（データとコードがあれば再現可能）]{.small}|

<center>

$\Downarrow$

QuartoやR Markdownを使用すると「分析結果」だけでなく「分析のプロセスそのもの」を成果物として保存・共有できる
</center>

## 文書生成の流れ（R Markdownの場合）

R&Knitr使用を前提として開発され、拡張されていくR Markdown

![](figs/intro/flow_rmarkdown.png)

## 文書生成の流れ（Quartoの場合）

複数言語&エンジン使用を念頭において開発されたQuarto

![](figs/intro/flow_quarto.png)

## 言語、エンジンの豊富さ

Quarto公式HPの[FAQ for R Markdown Users](https://quarto.org/docs/faq/rmarkdown.html){target="_blank"}により

> (...) Quarto is at its core multi-language and multi-engine (supporting Knitr, Jupyter, and Observable today and potentially other engines tomorrow). (...) Quarto was developed to be multilingual, beginning with R, Python, Javascript, and Julia, with the idea that it will work even for languages that don't yet  exist.

- 使用可能な言語：R、Python、Julia、Javascript、...
- 使用可能なエンジン：Knitr、Jupyter、Observable、...
- その他：PDF作成の際、$\LaTeX$でなくtypstも使用可能

## 生態系の統合

詳細な例は[公式ホームページ](https://quarto.org/docs/faq/rmarkdown.html#i-use-x-bookdown-blogdown-etc..-what-is-the-quarto-equivalent){target="_blank"}を確認

- ただし、Quartoは外部のパッケージでなく、拡張機能[（extensions）]{.small}が存在
- ダッシュボードの作成やShinyとの統合もOK

:::: {.columns}
::: {.column width=50%}
**R Markdown**

|目的|必要パッケージ|
|:---|:---|
|文書|不要|
|書籍|{bookdown}|
|スライド|{xaringan}|
|ホームページ|{blogdown}|
|ポスター|{posterdown}|
:::

::: {.column width=50%}
**Quarto**

|目的|必要パッケージ|
|:---|:---|
|文書|不要|
|書籍|不要|
|スライド|不要|
|ホームページ|不要|
|ポスター|???|
:::
::::

## 研究成果の共有ツールとしてのQuarto

#### 研究成果の共有方法

- [**文書**]{.alert}[（論文、報告書、レポート、書籍、...）]{.small}
- 学会発表のための[**スライド**]{.alert}、ポスター
- 再現/再生可能な研究のための[**再現用コード**]{.alert}
- ウェブサイト、ダッシュボード、ウェブアプリケーション

#### Quartoの役割

Quarto一つでは以上のすべて[（実はほとんど）]{.small}が作成できる

- 基礎的なMarkdown知識を身につければonline appendix、supplementary material、Harvard Dataverse用の再現用コードが作成可能
   - 静的ドキュメント[（PDF等）]{.small}だけでなく、HTMLベースの動的ドキュメントも
- 文書とスライドは片方を作っておけば、少しの修正で切り替えも可能

# **3** コース概要

## コース概要

進度によって内容が若干変わることがある。

1. Quartoとは & R Markdownとの比較
1. 実習環境の導入
1. Markdown文法の基礎
1. 文書の作成
1. スライドの作成
1. 作成した文書・スライドの共有

## 到達目標

- Markdown文法が分かる。
- Quartoで再現・再生用ファイルが作成できる。
   - PDF文書が作成できる。
- QuartoでHTMLスライドが作れる。
- 作成した文書、スライドが共有できる。
- より複雑なプロジェクトに取り組むための基礎知識を習得する。
   - Quarto公式のガイド/レファレンスを読めば応用できるようになる。

## コース資料の入手先

- <https://www.jaysong.net/quarto_intro>

```{r}
#| echo: false
qrcode::qr_code("https://www.jaysong.net/quarto_intro", ecl = "L") |> 
  plot(col = c(NA, "black"))
```
